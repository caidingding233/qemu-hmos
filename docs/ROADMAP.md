# QEMU é¸¿è’™ç‰ˆ (OSS) - æ ¸å¿ƒè·¯çº¿å›¾

æœ¬é¡¹ç›® (`qemu-hmos-oss`) æ—¨åœ¨æ‰“é€ ä¸€ä¸ªçº¯ç²¹ã€è‡ªç”±ã€å¼€æºçš„ HarmonyOS æœ¬åœ°è™šæ‹Ÿæœºç®¡ç†å·¥å…·ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å¯¹æ ‡ iOS çš„ UTMï¼Œä¸ºé¸¿è’™ç”Ÿæ€æä¾›åšå®çš„è™šæ‹ŸåŒ–åŸºç¡€è®¾æ–½ã€‚

> **è¯´æ˜**ï¼šæœ¬è·¯çº¿å›¾ä»…åŒ…å«å¼€æºç¤¾åŒºç‰ˆæ‰¿è¯ºäº¤ä»˜çš„åŠŸèƒ½ã€‚å…³äº Aether Engine (å•†ä¸šç‰ˆ) çš„äº‘åŒæ­¥ã€ä¼ä¸šçº§ç®¡ç†ç­‰é«˜çº§ç‰¹æ€§ï¼Œè¯·å‚é˜…å•†ä¸šç‰ˆæ–‡æ¡£ã€‚

---

## ğŸ¯ æ ¸å¿ƒæ„¿æ™¯

*   **æœ¬åœ°ä¼˜å…ˆ**ï¼šå®Œå…¨ç¦»çº¿å¯ç”¨ï¼Œä¸ä¾èµ–äº‘æœåŠ¡ã€‚
*   **æ¶æ„ä¸­ç«‹**ï¼šåŒæ—¶æ”¯æŒ ARM64 (é«˜æ€§èƒ½) å’Œ x86_64 (é«˜å…¼å®¹)ã€‚
*   **ä½“éªŒåŸç”Ÿ**ï¼šæ·±åº¦é›†æˆé¸¿è’™ UIï¼Œä¸ä»…æ˜¯"èƒ½è·‘"ï¼Œæ›´è¦"å¥½ç”¨"ã€‚

---

## ğŸ› ï¸ Phase 1: æ ¸å¿ƒå¼•æ“ä¸åŸºç¡€ä½“éªŒ (å·²å®Œæˆ/è¿›è¡Œä¸­)

è®©è™šæ‹Ÿæœºåœ¨é¸¿è’™è®¾å¤‡ä¸Šç¨³å®šè¿è¡Œçš„åŸºç¡€è®¾æ–½ã€‚

### 1. QEMU å¼•æ“ç§»æ¤
- [x] **å¤šæ¶æ„ç¼–è¯‘**ï¼šæ”¯æŒ `aarch64-softmmu`, `x86_64-softmmu`, `i386-softmmu`ã€‚
- [x] **JIT åŠ é€Ÿ (TCG)**ï¼šåœ¨æ”¯æŒçš„è®¾å¤‡ä¸Šé€šè¿‡ `prctl(0x6a6974, 1)` å¯ç”¨ JIT æƒé™ã€‚
- [x] **KVM æ¢æµ‹**ï¼šè‡ªåŠ¨æ£€æµ‹ `/dev/kvm`ï¼Œæ”¯æŒç¡¬ä»¶åŠ é€Ÿï¼ˆè‹¥ç³»ç»Ÿå¼€æ”¾ï¼‰å¹¶ä¼˜é›…é™çº§åˆ° TCGã€‚
- [x] **å¤šçº¿ç¨‹ä¼˜åŒ–**ï¼šé»˜è®¤å¼€å¯ `-accel tcg,thread=multi` æå‡æ€§èƒ½ã€‚

### 2. åŸºç¡€ VM ç®¡ç†
- [x] **å‘å¯¼å¼åˆ›å»º**ï¼šå¼•å¯¼ç”¨æˆ·ä¸‹è½½ ISOã€åˆ›å»ºç£ç›˜ã€é…ç½®å†…å­˜/CPUã€‚
- [x] **èµ„æºç®¡ç†**ï¼šç£ç›˜ç©ºé—´æ£€æŸ¥ã€é»˜è®¤èµ„æºé™åˆ¶ï¼ˆé¿å… OOMï¼‰ã€‚
- [x] **ç”Ÿå‘½å‘¨æœŸç®¡ç†**ï¼šå¯åŠ¨ã€å¼ºåˆ¶å…³é—­ã€æš‚åœï¼ˆæŒ‚èµ·ï¼‰ã€‚
- [x] **æ—¥å¿—ç³»ç»Ÿ**ï¼šQEMU è¿è¡Œæ—¥å¿—è½ç›˜ï¼ˆæ²™ç®±å†…ï¼‰ï¼Œæ”¯æŒå´©æºƒåˆ†æã€‚

### 3. æ˜¾ç¤ºä¸è¾“å…¥
- [x] **VNC é›†æˆ**ï¼šå†…ç½® noVNC/åŸç”Ÿ VNC è§†å›¾ï¼Œç”¨äºå®‰è£…é˜¶æ®µå’Œ BIOS æ“ä½œã€‚
- [ ] **RDP å®¢æˆ·ç«¯é›†æˆ**ï¼šé€šè¿‡ `hostfwd` æ˜ å°„ 3389 ç«¯å£ï¼Œä½¿ç”¨ FreeRDP æä¾›é«˜æ€§èƒ½æ¡Œé¢ä½“éªŒï¼ˆHiDPIã€éŸ³é¢‘ï¼‰ã€‚
- [ ] **è§¦æ§é€‚é…**ï¼šå°†é¸¿è’™è§¦æ‘¸äº‹ä»¶æ˜ å°„ä¸ºé¼ æ ‡/è§¦æ§æ¿äº‹ä»¶ã€‚

---

## ğŸš€ Phase 2: è¿›é˜¶åŠŸèƒ½ä¸ç³»ç»Ÿé›†æˆ (OSS æ‰¿è¯ºäº¤ä»˜)

æå‡å¯ç”¨æ€§ï¼Œè®©è™šæ‹ŸæœºçœŸæ­£èå…¥é¸¿è’™ç³»ç»Ÿã€‚

### 1. æ–‡ä»¶ä¸å­˜å‚¨
- [ ] **ISO ä¸‹è½½å™¨**ï¼šå†…ç½®å¤šçº¿ç¨‹æ–­ç‚¹ç»­ä¼ ä¸‹è½½å™¨ï¼Œæ”¯æŒä»å¾®è½¯å®˜ç½‘/Linux é•œåƒç«™ç›´æ¥ä¸‹è½½ã€‚
- [ ] **æœ¬åœ°æ–‡ä»¶å¤¹æ˜ å°„**ï¼š
    - Windows æ¥å®¾ï¼šé€šè¿‡ RDP é©±åŠ¨å™¨é‡å®šå‘ï¼Œå°†é¸¿è’™æ²™ç®±ç›®å½•æ˜ å°„ä¸º Z: ç›˜ã€‚
    - Linux æ¥å®¾ï¼šé€šè¿‡ virtio-9p æˆ– virtio-fs å®ç°é«˜æ€§èƒ½æ–‡ä»¶å…±äº«ã€‚
- [ ] **ç£ç›˜ç®¡ç†**ï¼šæ”¯æŒåŠ¨æ€æ‰©å±•ç£ç›˜å¤§å°ã€å¯¼å…¥å¤–éƒ¨ qcow2 é•œåƒã€‚

### 2. éŸ³é¢‘ä¸å¤šåª’ä½“
- [ ] **éŸ³é¢‘é€ä¼ **ï¼š
    - è¾“å‡ºï¼šVM å£°éŸ³ -> RDP/VNC -> é¸¿è’™ AudioRendererï¼ˆæ”¯æŒåå°æ’­æ”¾ï¼‰ã€‚
    - è¾“å…¥ï¼šé¸¿è’™éº¦å…‹é£ -> VM å½•éŸ³è®¾å¤‡ã€‚
- [ ] **åª’ä½“æ§åˆ¶æ˜ å°„**ï¼š
    - Windows ç«¯æ’­æ”¾éŸ³ä¹ -> é€šè¿‡è‡ªå®šä¹‰ DVC é€šé“ä¸ŠæŠ¥çŠ¶æ€ -> é¸¿è’™ AVSessionï¼ˆæ”¯æŒæ§åˆ¶ä¸­å¿ƒåˆ‡æ­Œã€æš‚åœï¼‰ã€‚

### 3. ç³»ç»Ÿçº§é›†æˆ (StartProgram)
- [ ] **åº”ç”¨å¿«æ·æ–¹å¼**ï¼šåœ¨é¸¿è’™ä¾§åˆ›å»º VM å†…åº”ç”¨çš„"ä»£ç†å›¾æ ‡"ã€‚
- [ ] **ä¸€é”®å¯åŠ¨**ï¼šç‚¹å‡»ä»£ç†å›¾æ ‡ -> è‡ªåŠ¨å¯åŠ¨ VM (å¦‚æœ‰å¿…è¦) -> é€šè¿‡ RDP RemoteApp æˆ– `/shell` å‘½ä»¤æ‹‰èµ· Windows é‡Œçš„æŒ‡å®š EXEã€‚
- [ ] **å®å†µçª—é€‚é…**ï¼šä¸‹è½½é•œåƒæˆ– VM å¯åŠ¨æ—¶ï¼Œåœ¨å®å†µçª—æ˜¾ç¤ºè¿›åº¦ã€‚

---

## ğŸ”§ Phase 3: æå®¢åŠŸèƒ½ (é«˜çº§é…ç½®)

ä¸ºå¼€å‘è€…å’Œç¡¬æ ¸ç”¨æˆ·æä¾›çš„è‡ªç”±åº¦ã€‚

### 1. é«˜çº§å‚æ•°é…ç½®
- [ ] **QEMU å‚æ•°ç¼–è¾‘å™¨**ï¼šå…è®¸ç”¨æˆ·æ‰‹åŠ¨è¿½åŠ /ä¿®æ”¹ QEMU å¯åŠ¨å‚æ•°ï¼ˆå¦‚ `-device usb-host`ï¼‰ã€‚
- [ ] **æ€§èƒ½æ¨¡å¼åˆ‡æ¢**ï¼š
    - æ ‡å‡†æ¨¡å¼
    - èŠ‚èƒ½æ¨¡å¼ (é™åˆ¶ CPU å ç”¨)
    - Turbo æ¨¡å¼ (å…¨æ ¸å¿ƒè§£é”)

### 2. å¢å¼ºå·¥å…· (Guest Tools)
- [ ] **Windows å¢å¼ºåŒ…**ï¼šä¸€é”®å®‰è£…è„šæœ¬ï¼Œè‡ªåŠ¨é…ç½® RDPã€é˜²ç«å¢™ã€QEMU Guest Agentã€Virtio é©±åŠ¨ã€‚
- [ ] **Linux å¢å¼ºè„šæœ¬**ï¼šè‡ªåŠ¨é…ç½®åˆ†è¾¨ç‡ã€å‰ªè´´æ¿å…±äº«ã€‚

### 3. å¤–è®¾æ”¯æŒ
- [ ] **USB é‡å®šå‘**ï¼šå°è¯•æ”¯æŒ USB é‡‡é›†å¡ã€U ç›˜ç›´é€šï¼ˆè§†é¸¿è’™ USB æƒé™å¼€æ”¾ç¨‹åº¦ï¼‰ã€‚
- [ ] **æ‘„åƒå¤´/éº¦å…‹é£**ï¼šé€šè¿‡ USB é‡å®šå‘æˆ–ç½‘ç»œæ‘„åƒå¤´åè®®å®ç°ä¼šè®®æ”¯æŒã€‚

---

## âš ï¸ å…è´£å£°æ˜ä¸åè®®

*   **å¼€æºåè®®**ï¼šæœ¬é¡¹ç›®ä»£ç éµå¾ª **GPL v2** åè®®ï¼ˆå› é“¾æ¥ QEMU åº“ï¼‰ã€‚
*   **UI ç‰ˆæƒ**ï¼šæœ¬é¡¹ç›®çš„ UI è®¾è®¡ä¸å›¾æ ‡èµ„æºå½’ Aether Engine å›¢é˜Ÿæ‰€æœ‰ï¼Œæˆæƒå¼€æºç¤¾åŒºä½¿ç”¨ï¼Œä½†ä¿ç•™å•†ä¸šæƒåˆ©ã€‚
*   **ä¸Šæ¸¸è‡´è°¢**ï¼šæ„Ÿè°¢ QEMU, FreeRDP, LibVNC ç­‰ä¸Šæ¸¸é¡¹ç›®çš„è´¡çŒ®ã€‚

---

> *Roadmap last updated: 2025-12-10*
